<div class="container-fluid py-4">
  <!-- Main Header with decorative lines -->
  <div class="text-center my-5">
    <h1 class="text-dark mb-3 position-relative">
      <span class="d-inline-block position-relative">
        <span class="d-inline-block mx-2" style="width: 30px;"></span>
        Emisije CO‚ÇÇ na prebivalca v Sloveniji 
        <span class="d-inline-block mx-2" style="width: 30px;"></span>
      </span>
    </h1>
  </div>

  <!-- Introduction Section -->
  <div class="mt-3 mb-4 px-6 text-start">
    <p class="text-dark fs-7 mb-3">
      Emisije CO‚ÇÇ na prebivalca so kljuƒçen pokazatelj okoljske odgovornosti posameznika. V Sloveniji so te emisije v obdobju 2000‚Äì2022 upadale, kar odra≈æa napredek v energetski uƒçinkovitosti, prehod na obnovljive vire in spremembe v ≈æivljenjskem slogu. Kljub temu ostaja prostor za izbolj≈°ave, saj so emisije ≈°e vedno nad svetovnim povpreƒçjem.
    </p>
    <p class="text-dark fs-7 mb-3">
      Leta 2022 je povpreƒçen prebivalec Slovenije izpustil 6.0 ton CO‚ÇÇ, kar je manj od evropskega povpreƒçja (6.4 t), a veƒç od svetovnega (4.7 t). Najvi≈°je emisije so bile zabele≈æene leta 2008 (9.03 t), predvsem zaradi gospodarske rasti in veƒçje porabe fosilnih goriv. Padci so opazni po finanƒçni krizi (2009) in pandemiji COVID-19 (2020).
    </p>
    <p class="text-dark fs-7 mb-3">
      Spodnji grafi razkrivajo trende, primerjave in dolgoroƒçne vzorce emisij na prebivalca. Razi≈°ƒçite, kako gospodarski dogodki in okoljske politike vplivajo na emisije, ter primerjajte Slovenijo z Evropo in svetom! 
    </p>
  </div>
  
  <!-- Key Metrics -->
  <div class="row mb-4 justify-content-between text-start">
    <div class="col-12 col-md-6 col-lg custom-col mb-3">
      <div class="card border-0 shadow-sm bg-light-primary transition-hover">
        <div class="card-body p-3 d-flex align-items-center">
          <div class="me-2">
            <span class="metric-icon-circle bg-primary text-white rounded-circle">
              <i class="fas fa-chart-area fa-sm"></i>
            </span>
          </div>
          <div>
            <p class="text-sm text-uppercase text-muted mb-1">Povpreƒçne emisije</p>
            <h5 class="font-weight-bolder mb-1" id="avgEmissions">-</h5>
            <p class="fs-7 mb-0">2000‚Äì2022</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-6 col-lg custom-col mb-3">
      <div class="card border-0 shadow-sm bg-light-primary transition-hover">
        <div class="card-body p-3 d-flex align-items-center">
          <div class="me-2">
            <span class="metric-icon-circle bg-primary text-white rounded-circle">
              <i class="fas fa-calculator fa-sm"></i>
            </span>
          </div>
          <div>
            <p class="text-sm text-uppercase text-muted mb-1">Mediana emisij</p>
            <h5 class="font-weight-bolder mb-1" id="medianEmissions">-</h5>
            <p class="fs-7 mb-0">2000‚Äì2022</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-6 col-lg custom-col mb-3">
      <div class="card border-0 shadow-sm bg-light-primary transition-hover">
        <div class="card-body p-3 d-flex align-items-center">
          <div class="me-2">
            <span class="metric-icon-circle bg-primary text-white rounded-circle">
              <i class="fas fa-sync-alt fa-sm"></i>
            </span>
          </div>
          <div>
            <p class="text-sm text-uppercase text-muted mb-1">Sprememba</p>
            <h5 class="font-weight-bolder mb-1" id="changeEmissions">-</h5>
            <p class="fs-7 mb-0">2000 vs. 2022</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-6 col-lg custom-col mb-3">
      <div class="card border-0 shadow-sm bg-light-primary transition-hover">
        <div class="card-body p-3 d-flex align-items-center">
          <div class="me-2">
            <span class="metric-icon-circle bg-primary text-white rounded-circle">
              <i class="fas fa-layer-group fa-sm"></i>
            </span>
          </div>
          <div>
            <p class="text-sm text-uppercase text-muted mb-1">Kumulativne emisije</p>
            <h5 class="font-weight-bolder mb-1" id="cumulativeEmissions">-</h5>
            <p class="fs-7 mb-0">2000‚Äì2022</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div id="loadingIndicator" class="text-center py-4">
    <div class="spinner-border text-primary" role="status" aria-hidden="true"></div>
    <p class="mt-2 text-dark fs-7">Nalaganje podatkov...</p>
  </div>

  <!-- Main Content -->
  <div id="contentContainer" style="display: none;">
    <!-- Subheader with decorative lines -->
    <div class="text-center my-5">
      <h3 class="text-dark mb-3 position-relative">
        <span class="d-inline-block position-relative">
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
          Trendi emisij na prebivalca
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
        </span>
      </h3>
    </div>

    <div class="row mt-4">
      <div class="col-lg-5 mb-lg-0 mb-4">
        <div class="card z-index-2 h-100">
          <div class="card-header pb-0 pt-3 bg-transparent">
            <p class="text-dark fs-7">
              Graf prikazuje gibanje emisij CO‚ÇÇ na prebivalca v Sloveniji skozi ƒças od osamosvojitve leta 1991. Emisije so dosegle vrh leta 2008 (9.03 t) in padle na 6.00 t leta 2022, kar ka≈æe na dolgoroƒçno zmanj≈°evanje.
              <br><br>
              Finanƒçna kriza leta 2008 in pandemija COVID-19 leta 2020 sta povzroƒçili najbolj opazna zmanj≈°anja emisij. Kljub gospodarski rasti v zadnjih letih se trend zmanj≈°evanja emisij na prebivalca nadaljuje, kar ka≈æe na uƒçinkovitost okoljskih politik in prehod na bolj trajnostne prakse.
            </p>
          </div>
        </div>
      </div>
      <div class="col-lg-7">
        <div class="card shadow-sm border-0 z-index-2 h-100 animate__animated animate__fadeIn chart-container">
          <div class="card-header bg-gradient-primary text-white pb-0 border-0">
            <h5 class="font-weight-bold text-white">Emisije CO‚ÇÇ na prebivalca skozi ƒças üìà</h5>
            <p class="text-white opacity-8 fs-7">Letne emisije CO‚ÇÇ na prebivalca (v tonah) za Slovenijo od 1991</p>
          </div>
      <button class="download-icon-btn" type="button" onclick="downloadPerCapitaSloCSV()" aria-label="Prenesi CSV podatke za emisije CO‚ÇÇ na prebivalec v Slovenija" title="Prenesi podatke v CSV formatu">
    <i class="fas fa-download"></i>
</button>
          <div class="card-body p-3">
            <div class="chart-wrapper">
              <canvas id="trend_chart" height="250" aria-label="Graf letnih emisij CO‚ÇÇ na prebivalca v Sloveniji"></canvas>
              <div class="chart-buttons mt-2 text-center">
                <button id="playButton" class="btn btn-sm btn-primary transition-hover">
                  <i class="fas fa-play"></i> 
                </button>
                <button id="stopButton" class="btn btn-sm btn-secondary transition-hover">
                  <i class="fas fa-stop"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Subheader with decorative lines -->
    <div class="text-center my-5">
      <h3 class="text-dark mb-3 mt-4 position-relative">
        <span class="d-inline-block position-relative">
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
          Primerjava z Evropo in svetom
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
        </span>
      </h3>
    </div>

    <div class="row mt-4">
      <div class="col-lg-5 mb-lg-0 mb-4">
        <div class="card z-index-2 h-100">
          <div class="card-header pb-0 pt-3 bg-transparent">
            <p class="text-dark fs-7">
              Slovenija je pod evropskim, a nad svetovnim povpreƒçjem emisij na prebivalca. Leta 2022 je Slovenija proizvedla 6.0 ton CO‚ÇÇ na prebivalca, kar je nekoliko manj od povpreƒçja EU (6.4 t) in veƒç od svetovnega povpreƒçja (4.7 t).
              <br><br>
              Kljub napredku v zadnjih letih Slovenija ≈°e vedno zaostaja za najbolj trajnostnimi evropskimi dr≈æavami, kot so ≈†vedska (3.8 t) in ≈†vica (4.0 t). To ka≈æe na potencial za nadaljnje izbolj≈°ave, zlasti na podroƒçjih energetike, prometa in industrije.
            </p>
          </div>
        </div>
      </div>
      <div class="col-lg-7">
        <div class="card shadow-sm border-0 z-index-2 h-100 animate__animated animate__fadeIn chart-container">
          <div class="card-header bg-gradient-primary text-white pb-0 border-0">
            <h5 class="font-weight-bold text-white">Primerjava emisij na prebivalca üåç</h5>
            <p class="text-white opacity-8 fs-7">Emisije CO‚ÇÇ na prebivalca v Sloveniji, EU in svetu (2022)</p>
          </div>
          <div class="card-body p-3">
            <div class="chart-wrapper">
              <canvas id="comparisonChart" height="250" aria-label="Primerjava emisij CO‚ÇÇ na prebivalca med Slovenijo, EU in svetom"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Subheader with decorative lines -->
    <div class="text-center my-5">
      <h3 class="text-dark mb-3 mt-4 position-relative">
        <span class="d-inline-block position-relative">
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
          Analiza sprememb emisij
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
        </span>
      </h3>
    </div>

    <div class="row mt-4">
      <div class="col-lg-6 mb-4">
        <div class="card shadow-sm border-0 z-index-2 h-100 animate__animated animate__fadeIn chart-container">
          <div class="card-header bg-gradient-primary text-white pb-0 border-0">
            <h5 class="font-weight-bold text-white">5-letno drseƒçe povpreƒçje üìä</h5>
            <p class="text-white opacity-8 fs-7">Glajenje nihanj v emisijah na prebivalca</p>
          </div>
          <div class="card-body p-3">
            <div class="chart-wrapper">
              <canvas id="rollingAverageChart" height="300" aria-label="5-letno drseƒçe povpreƒçje emisij CO‚ÇÇ na prebivalca"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-6 mb-4">
        <div class="card shadow-sm border-0 z-index-2 h-100 animate__animated animate__fadeIn chart-container">
          <div class="card-header bg-gradient-primary text-white pb-0 border-0">
            <h5 class="font-weight-bold text-white">Letne spremembe emisij üîÑ</h5>
            <p class="text-white opacity-8 fs-7">Odstotna sprememba glede na prej≈°nje leto</p>
          </div>
          <div class="card-body p-3">
            <div class="chart-wrapper">
              <canvas id="yearlyChangeChart" height="300" aria-label="Letne spremembe emisij CO‚ÇÇ na prebivalca"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Subheader with decorative lines -->
    <div class="text-center my-5">
      <h3 class="text-dark mb-3 mt-4 position-relative">
        <span class="d-inline-block position-relative">
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
          Dolgoroƒçni vpliv emisij
          <span class="d-inline-block mx-2" style="width: 30px;"></span>
        </span>
      </h3>
    </div>

    <div class="row mt-4">
      <div class="col-12">
        <div class="card shadow-sm border-0 z-index-2 h-100 animate__animated animate__fadeIn chart-container">
          <div class="card-header bg-gradient-primary text-white pb-0 border-0">
            <h5 class="font-weight-bold text-white">Kumulativne emisije na prebivalca üì¶</h5>
            <p class="text-white opacity-8 fs-7">Skupne emisije CO‚ÇÇ na prebivalca od leta 1991</p>
          </div>
          <div class="card-body p-3">
            <div class="chart-wrapper">
              <canvas id="cumulativeChart" height="250" aria-label="Kumulativne emisije CO‚ÇÇ na prebivalca v Sloveniji"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation Cards -->
    <div class="row mt-5">
      <div class="col-md-3 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
          <div class="card-body text-center">
            <div class="icon-circle bg-primary text-white mb-3 mx-auto">
              <i class="fas fa-chart-line fa-lg"></i>
            </div>
            <h5 class="card-title">Skupni pregled</h5>
            <p class="card-text text-muted">Celotni pregled emisij CO‚ÇÇ</p>
            <a href="/slovenia?tab=overview.html" class="btn btn-sm btn-outline-primary mt-2">Preberi veƒç</a>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
          <div class="card-body text-center">
            <div class="icon-circle bg-success text-white mb-3 mx-auto">
              <i class="fas fa-gas-pump fa-lg"></i>
            </div>
            <h5 class="card-title">Po vrsti goriva ‚õΩ</h5>
            <p class="card-text text-muted">Emisije po virih energije</p>
            <a href="/slovenia?tab=fuel.html" class="btn btn-sm btn-outline-primary mt-2">Preberi veƒç</a>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
          <div class="card-body text-center">
            <div class="icon-circle bg-warning text-white mb-3 mx-auto">
              <i class="fas fa-industry fa-lg"></i>
            </div>
            <h5 class="card-title">Po sektorju üè≠</h5>
            <p class="card-text text-muted">Emisije po gospodarskih sektorjih</p>
            <a href="/slovenia?tab=sector.html" class="btn btn-sm btn-outline-primary mt-2">Preberi veƒç</a>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
          <div class="card-body text-center">
            <div class="icon-circle bg-info text-white mb-3 mx-auto">
              <i class="fas fa-map-marked-alt fa-lg"></i>
            </div>
            <h5 class="card-title">Po regiji üó∫Ô∏è</h5>
            <p class="card-text text-muted">Regionalna porazdelitev emisij</p>
            <a href="/slovenia?tab=region.html" class="btn btn-sm btn-outline-primary mt-2">Preberi veƒç</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Dependencies -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<script src="/js/load-tabs.js"></script>
<script src="/js/capita.js"></script>

<!-- Optional Animation Library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />

<!-- Custom CSS -->
<style>
/* Existing styles unchanged */
.row.mb-4 .custom-col .card {
  min-height: 150px;
  display: flex;
  flex-direction: column;
}

.row.mb-4 .custom-col .card-body {
  flex: 1;
  display: flex;
  align-items: center;
}

.transition-hover {
  transition: all 0.3s ease;
}

.transition-hover:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1) !important;
}

.bg-gradient-primary {
  background: linear-gradient(90deg, #007bff 0%, #0056b3 100%);
}

.bg-light-primary {
  background: #e6f0ff;
}

.bg-light {
  background-color: #f8f9fa !important;
}

.btn-link {
  text-decoration: none;
}

.btn-link:hover {
  text-decoration: underline;
}

.border-3 {
  border-width: 3px !important;
}

.metric-icon-circle {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 40px;
  height: 40px;
  line-height: 40px;
  text-align: center;
  font-size: 16px;
}

/* Decorative lines for headers only */
h1.position-relative > span.position-relative,
h3.position-relative > span.position-relative {
  position: relative;
  display: inline-block;
}

h1.position-relative > span.position-relative::before,
h1.position-relative > span.position-relative::after,
h3.position-relative > span.position-relative::before,
h3.position-relative > span.position-relative::after {
  content: "";
  position: absolute;
  top: 50%;
  width: 150px;
  height: 2px;
  background-color: #a4c0de;
}

h1.position-relative > span.position-relative::before,
h3.position-relative > span.position-relative::before {
  right: 100%;
  margin-right: 15px;
}

h1.position-relative > span.position-relative::after,
h3.position-relative > span.position-relative::after {
  left: 100%;
  margin-left: 15px;
}

/* Responsive adjustments for headers */
@media (max-width: 768px) {
  h1.position-relative > span.position-relative::before,
  h1.position-relative > span.position-relative::after,
  h3.position-relative > span.position-relative::before,
  h3.position-relative > span.position-relative::after {
    width: 20px;
  }
  
  h1.position-relative > span.position-relative::before,
  h3.position-relative > span.position-relative::before {
    margin-right: 10px;
  }
  
  h1.position-relative > span.position-relative::after,
  h3.position-relative > span.position-relative::after {
    margin-left: 10px;
  }
}

/* Style for navigation cards */
.icon-circle {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
}

.hover-effect {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.hover-effect:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
}

.chart-container {
  max-height: 350px;
  overflow: hidden; 
}

.chart-container:has(#trend_chart) {
  max-height: 500px; 
}

.chart-wrapper {
  position: relative;
  height: 250px;
  width: 100%;
}

.chart-wrapper:has(#trend_chart) {
  height: 300px; 
}

.chart-wrapper canvas#trend_chart {
  max-height: 250px !important; 
  width: 100%;
}

.chart-wrapper canvas {
  max-height: 200px !important; 
  width: 100%;
}

.chart-buttons {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 0 10px;
}

/* Ensure consistent card body padding */
.card-body {
  padding: 15px !important;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .position-relative::before,
  .position-relative::after {
    width: 20px;
  }
  
  .position-relative::before {
    margin-right: 10px;
  }
  
  .position-relative::after {
    margin-left: 10px;
  }

  .chart-container {
    max-height: 300px; 
  }

  .chart-container:has(#trend_chart) {
    max-height: 450px;
  }

  .chart-wrapper {
    height: 220px; 
  }

  .chart-wrapper:has(#trend_chart) {
    height: 350px;
  }

  .chart-wrapper canvas {
    max-height: 180px !important; 
  }

  .chart-wrapper canvas#trend_chart {
    max-height: 250px !important; 
  }

  .chart-buttons {
    padding: 0 5px;
  }

  .chart-buttons .btn {
    font-size: 0.8rem; /* Smaller buttons on mobile */
    padding: 5px 10px;
  }
  .chart-container:has(#rollingAverageChart, #yearlyChangeChart) {
  max-height: 350px; /* Increase from 300px to 350px */
}
.chart-wrapper:has(#rollingAverageChart, #yearlyChangeChart) {
  height: 270px; /* Increase from 220px to 270px */
}
.chart-wrapper canvas#rollingAverageChart,
.chart-wrapper canvas#yearlyChangeChart {
  max-height: 220px !important; /* Increase from 180px to 220px */
}
}
.chart-container:has(#rollingAverageChart, #yearlyChangeChart) {
  max-height: 400px; /* Increase from 350px to 400px */
}
.chart-wrapper:has(#rollingAverageChart, #yearlyChangeChart) {
  height: 300px; /* Increase from 250px to 300px */
}
.chart-wrapper canvas#rollingAverageChart,
.chart-wrapper canvas#yearlyChangeChart {
  max-height: 250px !important; /* Increase from 200px to 250px */
}
</style>